<h1>Create Question</h1>
<c-card>
    <c-card-body>
        <form cForm [formGroup]="questionForm" (ngSubmit)="onSubmit()">
            <div class="mb-2 row">
                <div class="col-6">
                    <label cLabel for="chartLabel">ChartLabel: <span class="text-danger">(*)</span></label>
                    <input cFormControl formControlName="chartLabel" type="text" />
                    @if (chartLabel?.invalid && (chartLabel?.dirty || chartLabel?.touched)) {
                        <div class="text-danger">
                            @if (chartLabel?.hasError('required')) {
                                <div>Enter chart label, please!</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-6">
                    <label cLabel for="questionTypeId">Select Question type: <span
                            class="text-danger">(*)</span></label>
                    <select cFormControl formControlName="questionTypeId" cSelect>
                        <option [value]="-1">Select a question type</option>
                        @for (item of questionTypeList; track item?.id) {
                            <option [value]="item.id">{{ item.name }}</option>
                        }
                    </select>
                    @if (questionTypeId?.invalid && (questionTypeId?.dirty || questionTypeId?.touched)) {
                        <div class="text-danger">
                            @if (questionTypeId?.hasError('min')) {
                                <div>Select question type, please!</div>
                            }
                        </div>
                    }
                </div>
                <div class="col-6">
                    <label cLabel for="questionGroupId">Select Question group: </label>
                    <select cFormControl formControlName="questionGroupId" cSelect>
                        <option [value]="-1">Select question group</option>
                        @for (item of questionGroupList; track item?.id) {
                            <option [value]="item.id">{{ item.nameEN }}</option>
                        }
                    </select>
                    @if (questionGroupId?.invalid && (questionGroupId?.dirty || questionGroupId?.touched)) {
                        <div class="text-danger">
                            @if (questionGroupId?.hasError('min')) {
                                <div>Select question group, please!</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-6">
                    <label cLabel for="nameEN">NameEN: <span class="text-danger">(*)</span></label>
                    <input cFormControl formControlName="nameEN" type="text" />
                    @if (nameEN?.invalid && (nameEN?.dirty || nameEN?.touched)) {
                        <div class="text-danger">
                            @if (nameEN?.hasError('required')) {
                                <div>Enter NameEN, please!</div>
                            }
                        </div>
                    }
                </div>
                <div class="col-6">
                    <label cLabel for="nameVN">NameVN: <span class="text-danger">(*)</span></label>
                    <input cFormControl formControlName="nameVN" type="text" />
                    @if (nameVN?.invalid && (nameVN?.dirty || nameVN?.touched)) {
                        <div class="text-danger">
                            @if (nameVN?.hasError('required')) {
                                <div>Enter NameVN, please!</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-12">
                    <label cLabel for="description">Description:</label>
                    <textarea cFormControl formControlName="description" rows="3"></textarea>
                </div>
            </div>
            <div class="d-flex justify-content-end mb-2">
                <button (click)="toggleLiveCreateModel()" cButton type="button" class="ms-2 btn-info">Add
                    Answer</button>
            </div>
            <c-accordion class="mb-4">
                <c-accordion-item #item0="cAccordionItem" [visible]="true">
                    <ng-template cTemplateId="accordionHeaderTemplate">
                        <button (click)="item0.toggleItem()" [collapsed]="!item0.visible" cAccordionButton>
                            Answer List
                        </button>
                    </ng-template>
                    <ng-template cTemplateId="accordionBodyTemplate">
                        <table [hover]="true" [responsive]="true" [striped]="true" align="middle" cTable class="mb-0">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>NameEN</th>
                                    <th>NameVN</th>
                                    <th>Point</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @for (item of predefinedAnswerList; track $index; let i = $index) {
                                    <tr>
                                        <td>{{ i + 1 }}</td>
                                        <td>{{ item.nameEN }}</td>
                                        <td>{{ item.nameVN }}</td>
                                        <td>{{ item.point }}</td>
                                        <td class="d-flex justify-content-center">
                                            <button cButton type="button" (click)="updateData(i)"
                                                class="btn btn-warning me-2">Update</button>
                                            <button cButton type="button" (click)="deleteData(i)"
                                                class="btn btn-danger">Delete</button>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </ng-template>
                </c-accordion-item>
            </c-accordion>
            <div class="d-flex justify-content-end">
                <button cButton type="submit" type="submit" [disabled]="!createForm.valid"
                   >Submit</button>
                <button cButton type="button" routerLink="/surveys/extend-survey/questions" class="ms-2 btn-info"
                   >Back to list</button>
            </div>
        </form>
    </c-card-body>
</c-card>
<!-- Create Modal -->
<c-modal backdrop="static" [visible]="visibleCreateModal" (visibleChange)="handleLiveCreateModelChange($event)"
    id="verticallyCenteredCreateModal" size="lg">
    <c-modal-header>
        <h5 cModalTitle>Create Answer</h5>
        <button (click)="toggleLiveCreateModel()" cButtonClose></button>
    </c-modal-header>
    <form cForm [formGroup]="createForm" (ngSubmit)="onSubmitCreateForm()">
        <c-modal-body>
            <div class="mb-2 row">
                <div class="col-6">
                    <label for="point" class="me-2">Point: <span class="text-danger">(*)</span> </label>
                    <input formControlName="point" type="number" class="me-2 priorityInput">
                    @if (pointCreateForm?.invalid && (pointCreateForm?.dirty || pointCreateForm?.touched)) {
                        <div class="text-danger">
                            @if (pointCreateForm?.hasError('min') || pointCreateForm?.hasError('max')) {
                                <div>Point must be between 1 and 9999.</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-6">
                    <label cLabel for="nameEN" class="me-2">NameEN: <span class="text-danger">(*)</span> </label>
                    <input cFormControl formControlName="nameEN">
                    @if (nameENCreateForm?.invalid && (nameENCreateForm?.dirty || nameENCreateForm?.touched)) {
                        <div class="text-danger">
                            @if (nameENCreateForm?.hasError('required')) {
                                <div>NameEN is required.</div>
                            }
                        </div>
                    }
                </div>
                <div class="col-6">
                    <label cLabel for="nameVN">NameVN: <span class="text-danger">(*)</span></label>
                    <input cFormControl formControlName="nameVN">
                    @if (nameVNCreateForm?.invalid && (nameVNCreateForm?.dirty || nameVNCreateForm?.touched)) {
                        <div class="text-danger">
                            @if (nameVNCreateForm?.hasError('required')) {
                                <div>NameVN is required.</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-12">
                    <label cLabel for="description" class="me-2">Description: </label>
                    <textarea cFormControl formControlName="description" rows="3"></textarea>
                </div>
            </div>
        </c-modal-body>
        <c-modal-footer>
            <button (click)="toggleLiveCreateModel()" cButton color="secondary">
                Close
            </button>
            <button cButton type="submit" [disabled]="!createForm.valid" color="primary">Save</button>
        </c-modal-footer>
    </form>
</c-modal>
<!--Update Model-->
<c-modal backdrop="static" [visible]="visibleUpdateModal" (visibleChange)="handleLiveUpdateModelChange($event)"
    id="verticallyCenteredUpdateModal" size="lg">
    <c-modal-header>
        <h5 cModalTitle>Update Answer</h5>
        <button (click)="toggleLiveUpdateModel()" cButtonClose></button>
    </c-modal-header>
    <form cForm [formGroup]="updateForm" (ngSubmit)="onSubmitUpdateForm()">
        <c-modal-body>
            <div class="mb-2 d-flex flex-row">
                <div>
                    <label for="point" class="me-2">Point: <span class="text-danger">(*)</span> </label>
                    <input formControlName="point" type="number" class="me-2 priorityInput">
                    @if (pointUpdateForm?.invalid && (pointUpdateForm?.dirty || pointUpdateForm?.touched)) {
                        <div class="text-danger">
                            @if (pointUpdateForm?.hasError('min') || pointUpdateForm?.hasError('max')) {
                                <div>point must be between 1 and 9999.</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-6">
                    <label cLabel for="nameEN" class="me-2">NameEN: <span class="text-danger">(*)</span> </label>
                    <input cFormControl formControlName="nameEN">
                    @if (nameENUpdateForm?.invalid && (nameENUpdateForm?.dirty || nameENUpdateForm?.touched)) {
                        <div class="text-danger">
                            @if (nameENUpdateForm?.hasError('required')) {
                                <div>NameEN is required.</div>
                            }
                        </div>
                    }
                </div>
                <div class="col-6">
                    <label cLabel for="nameVN">NameVN: <span class="text-danger">(*)</span></label>
                    <input cFormControl formControlName="nameVN">
                    @if (nameVNUpdateForm?.invalid && (nameVNUpdateForm?.dirty || nameVNUpdateForm?.touched)) {
                        <div class="text-danger">
                            @if (nameVNUpdateForm?.hasError('required')) {
                                <div>NameVN is required.</div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col-12">
                    <label cLabel for="description" class="me-2">Description: </label>
                    <textarea cFormControl formControlName="description" rows="3"></textarea>
                </div>
            </div>
        </c-modal-body>
        <c-modal-footer>
            <button (click)="toggleLiveUpdateModel()" cButton color="secondary">
                Close
            </button>
            <button cButton type="submit" [disabled]="!updateForm.valid" color="primary">Save</button>
        </c-modal-footer>
    </form>
</c-modal>
<!--Delete Model-->
<c-modal backdrop="static" [visible]="visibleDelete" (visibleChange)="handleLiveDeleteChange($event)"
    id="verticallyCenteredDelete">
    <c-modal-header>
        <h5 cModalTitle>Confirmation</h5>
        <button (click)="toggleLiveDelete()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
        <p>Are you sure you want to delete this category?</p>
    </c-modal-body>
    <c-modal-footer>
        <button (click)="toggleLiveDelete()" cButton color="secondary">
            Close
        </button>
        <button cButton color="primary" (click)="deleteDataConfirm()">Confirm</button>
    </c-modal-footer>
</c-modal>